<html>
<head><meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.15.2/katex.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/antd/4.18.9/antd.compact.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>
<body>
<div style="margin:30px 30px 0 0"><div style="margin-bottom:15px"><b>Kernel:</b> <!-- -->R (system-wide)</div><div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h1 id="lab-6-the-leontief-input-output-model"><span>Lab 6: The Leontief Input-Output Model</span></h1><p><span>MTH 308: Applied Linear Algebra </span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><span>Spring 2022</span></p><p><span>Lab parts:</span></p><ul class="cocalc-slate-tight-list"><li><p><span>Part 1: Basic Leontief input-output model example, Exercise 1</span></p></li><li><p><span>Part 2: Efficient calculation of production vector, Exercise 2</span></p></li><li><p><span>Part 3: Large scale example, Exercise 3</span></p></li></ul></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="instructions"><span>Instructions</span></h2><p><span>Run each of the coding cells. For example cells, understand the commands and check that the outputs make sense. For exercise cells, write your own code where indicated to generate the correct output.</span></p><p><span><u>Submission:</u></span><span> Complete the following notebook in order. Once done, print the notebook and save as an HTML file. Upload your submission to the Canvas course page.</span></p><p><span><u>Rubric:</u></span><span> 15 total points, 3 points to running example cells and saving outputs, 4 points per exercise block with correct output saved.</span></p><p><span><u>Deadline:</u></span><span> Monday at midnight after the lab is assigned.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="part-1-introduction-to-leontief-input-output-model-exercise-1"><span>Part 1: Introduction to Leontief Input-Output Model, Exercise 1</span></h2><p><span>Here we implement a famous linear model from economics: </span><a href="https://en.wikipedia.org/wiki/Input%E2%80%93output_model" target="_blank" rel="noopener"><span>https://en.wikipedia.org/wiki/Input–output_model</span></a><span></span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="model-explanation"><span>Model explanation</span></h4><p><span>Define the </span><span><em>production vector</em></span><span> </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span> in </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="double-struck">R</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">\mathbb{R}^n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6889em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span><span> as the amount of goods or services produced by </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span></span><span> sectors of a nation&#x27;s economy. Then, balancing production with demand, we have</span></p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mi>C</mi><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>+</mo><mover accent="true"><mi>d</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{x} = C\vec{x} + \vec{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span></span><p><span>where </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>d</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span> is the </span><span><em>final demand</em></span><span> by consumer sectors (people, government, education, etc) and </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">C\vec{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span> computes the </span><span><em>intermediate demand</em></span><span> consumed by producing sectors. Below is a depiction of this idea.</span></p><p><span></span><img src="attachment:image1.png" alt="" title="" style="width:40%;max-width:100%;max-height:100%;object-fit:cover"/><span></span></p><p><span>Solving this system by hand, we get</span></p><span><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mi>C</mi><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>+</mo><mover accent="true"><mi>d</mi><mo>⃗</mo></mover><mspace width="1em"/><mo>→</mo><mspace width="1em"/><mi>I</mi><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>−</mo><mi>C</mi><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mover accent="true"><mi>d</mi><mo>⃗</mo></mover><mspace width="1em"/><mo>→</mo><mspace width="1em"/><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><mi>C</mi><mo stretchy="false">)</mo><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mover accent="true"><mi>d</mi><mo>⃗</mo></mover><mspace width="1em"/><mo>→</mo><mspace width="1em"/><mover accent="true"><mi>x</mi><mo>⃗</mo></mover><mo>=</mo><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><mi>C</mi><msup><mo stretchy="false">)</mo><mrow><mo>−</mo><mn>1</mn></mrow></msup><mover accent="true"><mi>d</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{x} = C\vec{x} + \vec{d} \quad \rightarrow \quad
I\vec{x} - C\vec{x} = \vec{d} \quad \rightarrow \quad
(I-C)\vec{x} = \vec{d} \quad \rightarrow \quad
\vec{x} = (I-C)^{-1}\vec{d}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7973em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9774em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.2274em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose"><span class="mclose">)</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8641em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9774em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">d</span></span><span style="top:-3.2634em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.0688em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span></span><p><span>assuming </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>I</mi><mo>−</mo><mi>C</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(I-C)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span><span class="mclose">)</span></span></span></span></span><span> is invertible.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="exercise-1-mini-economy"><span>Exercise 1: Mini-economy</span></h4><p><span>Consider an economy of 3 sectors with </span><span><em>intermediate demand</em></span><span> found historically to be</span></p><p><span></span><img src="attachment:image2.png" alt="" title="" style="width:40%;max-width:100%;max-height:100%;object-fit:cover"/><span></span></p><p><span>and </span><span><em>final demand</em></span><span> as 50 units manufacturing, 30 units agriculture, and 20 units services. Use the coding block below to find the </span><span><em>production vector</em></span><span> </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span> which will satisfy this demand.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->1<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">##################</span><span>
</span><span class="cm-comment"># EXERCISE CELL</span><span>
</span><span class="cm-comment">##################</span><span>
</span><span>
</span><span class="cm-variable">library</span><span>(</span><span class="cm-variable">matlib</span><span>)</span><span>
</span><span>
</span><span class="cm-comment">##########################</span><span>
</span><span class="cm-comment"># beginning of your code</span><span>
</span><span>
</span><span class="cm-variable">C</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">matrix</span><span>(</span><span class="cm-variable">c</span><span>(</span><span class="cm-number">.5</span><span>,</span><span> </span><span class="cm-number">.4</span><span>,</span><span> </span><span class="cm-number">.2</span><span>,</span><span>
</span><span>             </span><span class="cm-number">.2</span><span>,</span><span> </span><span class="cm-number">.3</span><span>,</span><span> </span><span class="cm-number">.1</span><span>,</span><span>
</span><span>             </span><span class="cm-number">.1</span><span>,</span><span> </span><span class="cm-number">.1</span><span>,</span><span> </span><span class="cm-number">.3</span><span>)</span><span>,</span><span> </span><span class="cm-variable">nrow</span><span class="cm-operator">=</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">ncol</span><span class="cm-operator">=</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">byrow</span><span class="cm-operator">=</span><span class="cm-atom">TRUE</span><span>)</span><span>
</span><span class="cm-variable">I</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">diag</span><span>(</span><span class="cm-number">3</span><span>)</span><span>
</span><span class="cm-variable">d</span><span> </span><span class="cm-operator arrow">&lt;-</span><span class="cm-variable">c</span><span>(</span><span class="cm-number">50</span><span>,</span><span> </span><span class="cm-number">30</span><span>,</span><span> </span><span class="cm-number">20</span><span>)</span><span>
</span><span>
</span><span>
</span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">inv</span><span>(</span><span class="cm-variable">I</span><span class="cm-operator">-</span><span class="cm-variable">C</span><span>)</span><span> </span><span class="cm-operator variable-2">%*%</span><span> </span><span class="cm-variable">d</span><span>
</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Production vector&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">x</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Intermediate demand&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">C</span><span> </span><span class="cm-operator variable-2">%*%</span><span> </span><span class="cm-variable">x</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># end of your code</span><span>
</span><span class="cm-comment">##########################</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px">Out[<!-- -->1<!-- -->]:</div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="background-color:#fdd;white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>Warning message in rgl.init(initValue, onlyNULL):
“RGL: unable to open X11 display”
Warning message:
“&#x27;rgl.init&#x27; failed, running with &#x27;rgl.useNULL = TRUE&#x27;.”
</span></div><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>[1] &quot;Production vector&quot;
          [,1]
[1,] 225.92593
[2,] 118.51852
[3,]  77.77778
[1] &quot;Intermediate demand&quot;
          [,1]
[1,] 175.92593
[2,]  88.51852
[3,]  57.77778
</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="solution-explanation"><span>Solution explanation.</span></h4><p><span>Explain your findings from the above exercise cell coding block including a discussion of both the production vector and intermediate demands.</span></p><p><span>Solving the equation as above, we see the needed production is 225.9 units for Manufacturing, 118.5 units for Ag, and 77.8 units for Services. The intermediate demands for each are 175.9 units for Manufacturing, 88.5 units for Ag, and 57.8 units for Services.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="part-2-efficient-production-vector-calculation-exercise-2"><span>Part 2: Efficient production vector calculation, Exercise 2</span></h2><p><span>There is an alternate approach to computing production vector </span><span><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>x</mi><mo>⃗</mo></mover></mrow><annotation encoding="application/x-tex">\vec{x}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.714em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.714em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2077em;"><span class="overlay" style="height:0.714em;width:0.471em;"><svg xmlns="http://www.w3.org/2000/svg" width='0.471em' height='0.714em' style='width:0.471em' viewBox='0 0 471 714' preserveAspectRatio='xMinYMin'><path d='M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z'/></svg></span></span></span></span></span></span></span></span></span></span></span><span> without needing to find the inverse of a matrix. For large enough systems, this can be more efficient computationally. Read the below explanation from the textbook.</span><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><img src="attachment:image3.png" alt="" title="" style="width:60%;max-width:100%;max-height:100%;object-fit:cover"/><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><img src="attachment:image4.png" alt="" title="" style="width:60%;max-width:100%;max-height:100%;object-fit:cover"/><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><span>Note, equation 8 resembles the formula of a geometric series from Calculus 2 (</span><a href="https://en.wikipedia.org/wiki/Geometric_series" target="_blank" rel="noopener"><span>https://en.wikipedia.org/wiki/Geometric_series</span></a><span>).</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="exercise-2-efficient-production-vector-calculation"><span>Exercise 2: Efficient production vector calculation</span></h4><p><span>Use the below coding block to find the production vector from Exercise 1 using formula (6) from the textbook explanation above. Note, this is an approximate approach and you will need to create a rule for your calculation to stop.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->2<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">##################</span><span>
</span><span class="cm-comment"># EXERCISE CELL</span><span>
</span><span class="cm-comment">##################</span><span>
</span><span>
</span><span class="cm-comment">##########################</span><span>
</span><span class="cm-comment"># beginning of your code</span><span>
</span><span>
</span><span class="cm-variable">demandIter</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-keyword">function</span><span>(</span><span class="cm-variable">C</span><span>,</span><span class="cm-variable">d</span><span>,</span><span class="cm-variable">precision</span><span>,</span><span class="cm-variable">maxIter</span><span>)</span><span>{</span><span>
</span><span>    </span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">d</span><span>
</span><span>    </span><span class="cm-keyword">for</span><span> </span><span>(</span><span class="cm-variable">i</span><span> </span><span class="cm-keyword">in</span><span> </span><span class="cm-variable">c</span><span>(</span><span class="cm-number">1</span><span class="cm-operator">:</span><span class="cm-variable">maxIter</span><span>)</span><span>)</span><span>{</span><span>
</span><span>        </span><span class="cm-variable">xprev</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">x</span><span>
</span><span>        </span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">d</span><span> </span><span class="cm-operator">+</span><span> </span><span class="cm-variable">C</span><span class="cm-operator variable-2">%*%</span><span class="cm-variable">x</span><span>
</span><span>        </span><span class="cm-keyword">if</span><span> </span><span>(</span><span class="cm-variable">max</span><span>(</span><span class="cm-variable">abs</span><span>(</span><span class="cm-variable">x</span><span class="cm-operator">-</span><span class="cm-variable">xprev</span><span>)</span><span>)</span><span class="cm-operator">&lt;</span><span class="cm-variable">precision</span><span>)</span><span>{</span><span>
</span><span>            </span><span class="cm-builtin">return</span><span>(</span><span class="cm-builtin">list</span><span>(</span><span class="cm-variable">x</span><span>,</span><span class="cm-variable">i</span><span>)</span><span>)</span><span>
</span><span>        </span><span>}</span><span>
</span><span>    </span><span>}</span><span>
</span><span>    </span><span class="cm-builtin">return</span><span>(</span><span class="cm-builtin">list</span><span>(</span><span class="cm-variable">x</span><span>,</span><span class="cm-variable">i</span><span>)</span><span>)</span><span>
</span><span>}</span><span>
</span><span>
</span><span>
</span><span class="cm-variable">C</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">matrix</span><span>(</span><span class="cm-variable">c</span><span>(</span><span class="cm-number">.5</span><span>,</span><span> </span><span class="cm-number">.4</span><span>,</span><span> </span><span class="cm-number">.2</span><span>,</span><span>
</span><span>             </span><span class="cm-number">.2</span><span>,</span><span> </span><span class="cm-number">.3</span><span>,</span><span> </span><span class="cm-number">.1</span><span>,</span><span>
</span><span>             </span><span class="cm-number">.1</span><span>,</span><span> </span><span class="cm-number">.1</span><span>,</span><span> </span><span class="cm-number">.3</span><span>)</span><span>,</span><span> </span><span class="cm-variable">nrow</span><span class="cm-operator">=</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">ncol</span><span class="cm-operator">=</span><span class="cm-number">3</span><span>,</span><span> </span><span class="cm-variable">byrow</span><span class="cm-operator">=</span><span class="cm-atom">TRUE</span><span>)</span><span>
</span><span class="cm-variable">d</span><span> </span><span class="cm-operator arrow">&lt;-</span><span class="cm-variable">c</span><span>(</span><span class="cm-number">50</span><span>,</span><span> </span><span class="cm-number">30</span><span>,</span><span> </span><span class="cm-number">20</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">precision</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-number">0.01</span><span>
</span><span class="cm-variable">maxIter</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-number">100</span><span>
</span><span>
</span><span class="cm-variable">result</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">demandIter</span><span>(</span><span class="cm-variable">C</span><span>,</span><span class="cm-variable">d</span><span>,</span><span> </span><span class="cm-variable">precision</span><span>,</span><span> </span><span class="cm-variable">maxIter</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">result</span><span>[</span><span>[</span><span class="cm-number">1</span><span>]</span><span>]</span><span>
</span><span class="cm-variable">iterUsed</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">result</span><span>[</span><span>[</span><span class="cm-number">2</span><span>]</span><span>]</span><span>
</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Production vector via iteration:&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">x</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">paste</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Iterations used to obtain precision &quot;</span><span>,</span><span> </span><span class="cm-variable">precision</span><span>)</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">iterUsed</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># end of your code</span><span>
</span><span class="cm-comment">##########################</span><span>
</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px">Out[<!-- -->2<!-- -->]:</div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>[1] &quot;Production vector via iteration:&quot;
          [,1]
[1,] 225.90081
[2,] 118.50596
[3,]  77.76967
[1] &quot;Iterations used to obtain precision  0.01&quot;
[1] 33
</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="solution-explanation"><span>Solution explanation.</span></h4><p><span>Explain your findings in the above coding block here.</span></p><p><span>See above coding output.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h2 id="part-3-large-scale-example-exercise-3"><span>Part 3: Large scale example, Exercise 3</span></h2><p><span>Here you will explore a larger scale example.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="exercise-3-large-scale-example"><span>Exercise 3: Large scale example</span></h4><p><span>Solve the following two textbook exercises.</span><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><img src="attachment:image5.png" alt="" title="" style="width:40%;max-width:100%;max-height:100%;object-fit:cover"/><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><div style="display:inline"><div><br/></div></div><span><span style="white-space:normal"> </span><span></span></span><img src="attachment:image6.png" alt="" title="" style="width:40%;max-width:100%;max-height:100%;object-fit:cover"/><span></span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->3<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">##################</span><span>
</span><span class="cm-comment"># EXERCISE CELL FOR PROBLEM 13</span><span>
</span><span class="cm-comment">##################</span><span>
</span><span>
</span><span class="cm-variable">C</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">matrix</span><span>(</span><span class="cm-variable">c</span><span>(</span><span class="cm-number">.1588</span><span>,</span><span class="cm-number">.0064</span><span>,</span><span class="cm-number">.0025</span><span>,</span><span class="cm-number">.0304</span><span>,</span><span class="cm-number">.0014</span><span>,</span><span class="cm-number">.0083</span><span>,</span><span class="cm-number">.1594</span><span>,</span><span>
</span><span class="cm-number">.0057</span><span>,</span><span class="cm-number">.2645</span><span>,</span><span class="cm-number">.0436</span><span>,</span><span class="cm-number">.0099</span><span>,</span><span class="cm-number">.0083</span><span>,</span><span class="cm-number">.0201</span><span>,</span><span class="cm-number">.3413</span><span>,</span><span>
</span><span class="cm-number">.0264</span><span>,</span><span class="cm-number">.1506</span><span>,</span><span class="cm-number">.3557</span><span>,</span><span class="cm-number">.0139</span><span>,</span><span class="cm-number">.0142</span><span>,</span><span class="cm-number">.0070</span><span>,</span><span class="cm-number">.0236</span><span>,</span><span>
</span><span class="cm-number">.3299</span><span>,</span><span class="cm-number">.0565</span><span>,</span><span class="cm-number">.0495</span><span>,</span><span class="cm-number">.3636</span><span>,</span><span class="cm-number">.0204</span><span>,</span><span class="cm-number">.0483</span><span>,</span><span class="cm-number">.0649</span><span>,</span><span>
</span><span class="cm-number">.0089</span><span>,</span><span class="cm-number">.0081</span><span>,</span><span class="cm-number">.0333</span><span>,</span><span class="cm-number">.0295</span><span>,</span><span class="cm-number">.3412</span><span>,</span><span class="cm-number">.0237</span><span>,</span><span class="cm-number">.0020</span><span>,</span><span>
</span><span class="cm-number">.1190</span><span>,</span><span class="cm-number">.0901</span><span>,</span><span class="cm-number">.0996</span><span>,</span><span class="cm-number">.1260</span><span>,</span><span class="cm-number">.1722</span><span>,</span><span class="cm-number">.2368</span><span>,</span><span class="cm-number">.3369</span><span>,</span><span>
</span><span class="cm-number">.0063</span><span>,</span><span class="cm-number">.0126</span><span>,</span><span class="cm-number">.0196</span><span>,</span><span class="cm-number">.0098</span><span>,</span><span class="cm-number">.0064</span><span>,</span><span class="cm-number">.0132</span><span>,</span><span class="cm-number">.0012</span><span>)</span><span>,</span><span> </span><span class="cm-variable">nrow</span><span class="cm-operator">=</span><span class="cm-number">7</span><span>,</span><span> </span><span class="cm-variable">ncol</span><span class="cm-operator">=</span><span class="cm-number">7</span><span>,</span><span> </span><span class="cm-variable">byrow</span><span class="cm-operator">=</span><span class="cm-atom">TRUE</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">d</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">c</span><span>(</span><span class="cm-number">74000</span><span>,</span><span class="cm-number">56000</span><span>,</span><span class="cm-number">10500</span><span>,</span><span class="cm-number">25000</span><span>,</span><span class="cm-number">17500</span><span>,</span><span class="cm-number">196000</span><span>,</span><span class="cm-number">5000</span><span>)</span><span>
</span><span>
</span><span class="cm-comment">##########################</span><span>
</span><span class="cm-comment"># beginning of your code</span><span>
</span><span class="cm-variable">I</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">diag</span><span>(</span><span class="cm-variable">nrow</span><span>(</span><span class="cm-variable">C</span><span>)</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">inv</span><span>(</span><span class="cm-variable">I</span><span class="cm-operator">-</span><span class="cm-variable">C</span><span>)</span><span> </span><span class="cm-operator variable-2">%*%</span><span> </span><span class="cm-variable">d</span><span>
</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Production vector&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">x</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Intermediate demand&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">C</span><span> </span><span class="cm-operator variable-2">%*%</span><span> </span><span class="cm-variable">x</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># end of your code</span><span>
</span><span class="cm-comment">##########################</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px">Out[<!-- -->3<!-- -->]:</div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>[1] &quot;Production vector&quot;
          [,1]
[1,]  99575.65
[2,]  97703.02
[3,]  51230.52
[4,] 131569.92
[5,]  49488.49
[6,] 329554.45
[7,]  13835.33
[1] &quot;Intermediate demand&quot;
           [,1]
[1,]  25575.653
[2,]  41703.022
[3,]  40730.523
[4,] 106569.922
[5,]  31988.492
[6,] 133554.452
[7,]   8835.336
</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->4<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span class="cm-comment">##################</span><span>
</span><span class="cm-comment"># EXERCISE CELL FOR PROBLEM 15</span><span>
</span><span class="cm-comment">##################</span><span>
</span><span>
</span><span class="cm-comment">##########################</span><span>
</span><span class="cm-comment"># beginning of your code</span><span>
</span><span>
</span><span class="cm-variable">precision</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-number">0.00001</span><span>
</span><span class="cm-variable">maxIter</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-number">100</span><span>
</span><span>
</span><span class="cm-variable">result</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">demandIter</span><span>(</span><span class="cm-variable">C</span><span>,</span><span class="cm-variable">d</span><span>,</span><span> </span><span class="cm-variable">precision</span><span>,</span><span> </span><span class="cm-variable">maxIter</span><span>)</span><span>
</span><span>
</span><span class="cm-variable">x</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">result</span><span>[</span><span>[</span><span class="cm-number">1</span><span>]</span><span>]</span><span>
</span><span class="cm-variable">iterUsed</span><span> </span><span class="cm-operator arrow">&lt;-</span><span> </span><span class="cm-variable">result</span><span>[</span><span>[</span><span class="cm-number">2</span><span>]</span><span>]</span><span>
</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Production vector via iteration:&quot;</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">x</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">paste</span><span>(</span><span class="cm-string">&quot;</span><span class="cm-string">Iterations used to obtain precision &quot;</span><span>,</span><span> </span><span class="cm-variable">precision</span><span>)</span><span>)</span><span>
</span><span class="cm-variable">print</span><span>(</span><span class="cm-variable">iterUsed</span><span>)</span><span>
</span><span>
</span><span class="cm-comment"># end of your code</span><span>
</span><span class="cm-comment">##########################</span><span>
</span></div></pre></div></div><div style="display:flex;flex-direction:row;align-items:stretch" cocalc-test="cell-output"><div class="ant-btn ant-btn-default" style="border-color:transparent;font-size:inherit;padding:0;display:flex;flex-direction:column;height:auto"><div style="color:#D84315;min-width:7em;font-family:monospace;text-align:right;padding-right:5px;padding-bottom:2px">Out[<!-- -->4<!-- -->]:</div><div style="flex:1"></div> </div><div style="flex:1;overflow-x:auto;line-height:normal;background-color:#fff;border:0;margin-bottom:0;margin-left:1px" class="cocalc-jupyter-rendered"><div style="white-space:pre-wrap;word-wrap:break-word;font-family:monospace;padding-top:5px;padding-bottom:5px"><span>[1] &quot;Production vector via iteration:&quot;
          [,1]
[1,]  99575.65
[2,]  97703.02
[3,]  51230.52
[4,] 131569.92
[5,]  49488.49
[6,] 329554.45
[7,]  13835.34
[1] &quot;Iterations used to obtain precision  1e-05&quot;
[1] 36
</span></div></div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px"></div><div style="width:100%"><h4 id="solution-explanation"><span>Solution explanation.</span></h4><p><span>Explain your findings from the above coding blocks here.</span></p><p><span>See above coding output.</span></p></div></div><div></div></div><div style="margin-bottom:10px"><div style="display:flex;flex-direction:row;align-items:stretch"><div style="color:#303F9F;min-width:7em;font-family:monospace;text-align:right;padding-right:5px">In [<!-- -->0<!-- -->]:</div><div style="width:100%;border-radius:2px;position:relative;overflow-x:auto;border:1px solid rgb(207, 207, 207)"><pre class="CodeMirror cm-s-default  CodeMirror-wrap" style="width:100%;overflow-x:auto;line-height:normal;height:auto;font-size:inherit;margin-bottom:0;padding:4px;white-space:pre-wrap;word-wrap:break-word;word-break:normal;border:0;background:white"><div style="margin-left:0"><span>
</span></div></pre></div></div><div></div></div></div></div>
</body>
